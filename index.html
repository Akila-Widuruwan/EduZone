<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://i.postimg.cc/gJ1rTY1B/Gemini-Generated-Image-ou99oou99oou99oo.png">
    <title>EduZone LK - Learn Maths & Physics</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: white;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        /* NAVBAR */
        .navbar {
            background: rgba(15, 32, 39, 0.95);
            padding: 0;
            border-bottom: 3px solid #3498db;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 80px;
        }
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #3498db;
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            font-family: 'Roboto Slab', serif;
        }
        .logo-icon {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        /* MOBILE BUTTONS */
        .mobile-buttons {
            display: none;
            gap: 15px;
        }
        .mobile-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .mobile-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            transform: scale(1.05);
        }
        
        /* DESKTOP NAV MENU */
        .nav-menu {
            display: flex;
            list-style: none;
            gap: 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 5px;
        }
        .nav-link {
            color: white;
            text-decoration: none;
            padding: 15px 25px;
            display: block;
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        .nav-link:hover::before {
            left: 100%;
        }
        .nav-link.active {
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        /* DESKTOP SEARCH */
        .search-container {
            position: relative;
            width: 280px;
        }
        .search-container input {
            width: 100%;
            padding: 12px 45px 12px 20px;
            border: 2px solid rgba(52, 152, 219, 0.3);
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .search-container input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        .search-container i {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #3498db;
            font-size: 1.1rem;
        }
        
        /* MOBILE MENU OVERLAY */
        .mobile-menu-overlay {
            display: none;
            position: fixed;
            top: 80px;
            left: 0;
            width: 100%;
            height: calc(100vh - 80px);
            background: rgba(15, 32, 39, 0.98);
            z-index: 999;
            flex-direction: column;
            padding: 2rem 0;
            backdrop-filter: blur(10px);
        }
        .mobile-menu-overlay.active {
            display: flex;
        }
        .mobile-nav-link {
            color: white;
            text-decoration: none;
            padding: 20px;
            font-size: 1.2rem;
            border-left: 4px solid transparent;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }
        .mobile-nav-link.active {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border-left-color: #3498db;
        }
        .mobile-nav-link:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        /* MOBILE SEARCH OVERLAY */
        .mobile-search-overlay {
            display: none;
            position: fixed;
            top: 80px;
            left: 0;
            width: 100%;
            background: rgba(15, 32, 39, 0.98);
            padding: 1.5rem;
            z-index: 999;
            border-bottom: 2px solid #3498db;
            backdrop-filter: blur(10px);
        }
        .mobile-search-overlay.active {
            display: block;
        }
        .mobile-search-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid rgba(52, 152, 219, 0.3);
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1.1rem;
        }

        /* MAIN CONTENT */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .hero {
            text-align: center;
            margin-bottom: 3rem;
            padding: 3rem 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .hero h1 {
            font-size: 3.5rem;
            background: linear-gradient(135deg, #3498db, #2ecc71, #f1c40f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            font-weight: 700;
            font-family: 'Roboto Slab', serif;
        }
        .hero p {
            font-size: 1.3rem;
            color: #bdc3c7;
            max-width: 700px;
            margin: 0 auto;
        }
        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 2rem;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #3498db;
        }
        .stat-label {
            font-size: 1rem;
            color: #bdc3c7;
        }
        
        /* CATEGORY SECTIONS */
        .category-section {
            margin-bottom: 3rem;
            display: none;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        #newSection {
            display: block;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid rgba(52, 152, 219, 0.3);
        }
        .section-title {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #3498db, #2ecc71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-family: 'Roboto Slab', serif;
        }
        .section-icon {
            font-size: 2.5rem;
            margin-right: 15px;
            vertical-align: middle;
        }
        .maths-icon {
            color: #3498db;
        }
        .physics-icon {
            color: #e74c3c;
        }
        .new-icon {
            color: #2ecc71;
        }
        
        /* VIDEO GRID */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }
        .video-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        .video-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            border-color: rgba(52, 152, 219, 0.5);
        }
        .video-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(46, 204, 113, 0.1));
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 1;
        }
        .video-card:hover::before {
            opacity: 1;
        }
        .video-thumbnail {
            height: 180px;
            position: relative;
            overflow: hidden;
            background: #1a1a2e;
        }
        .thumbnail-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        .video-card:hover .thumbnail-image {
            transform: scale(1.05);
        }
        .video-info {
            padding: 1.5rem;
            position: relative;
            z-index: 2;
        }
        .video-title {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: white;
            line-height: 1.4;
        }
        .video-description {
            color: #bdc3c7;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        .video-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #95a5a6;
            font-size: 0.85rem;
        }
        .video-duration {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        .video-tags {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .video-tag {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        .physics-tag {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        .maths-tag {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .loading {
            text-align: center;
            padding: 3rem;
            color: #bdc3c7;
            font-size: 1.1rem;
        }
        .loading i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #3498db;
        }
        
        /* NEW VIDEO PLAYER MODAL */
        .video-player-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        .video-player-modal.active {
            display: flex;
        }
        .player-container {
            width: 100%;
            max-width: 1000px;
            background: rgba(15, 32, 39, 0.95);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .player-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: white;
            max-width: 80%;
        }
        .player-close {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid rgba(231, 76, 60, 0.3);
            color: #e74c3c;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        .player-close:hover {
            background: rgba(231, 76, 60, 0.4);
            transform: scale(1.05);
        }
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            background: #000;
        }
        .video-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        .player-info {
            padding: 25px;
        }
        .player-description {
            color: #bdc3c7;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 1rem;
        }
        .player-meta {
            display: flex;
            justify-content: space-between;
            color: #95a5a6;
            font-size: 0.95rem;
            margin-bottom: 20px;
        }
        .player-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .player-action-btn {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.3);
            color: #3498db;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }
        .player-action-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            transform: translateY(-2px);
        }
        .like-btn {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }
        .like-btn:hover {
            background: rgba(46, 204, 113, 0.3);
        }
        .save-btn {
            background: rgba(241, 196, 15, 0.2);
            border: 1px solid rgba(241, 196, 15, 0.3);
            color: #f1c40f;
        }
        .save-btn:hover {
            background: rgba(241, 196, 15, 0.3);
        }
        
        /* FOOTER */
        .footer {
            background: rgba(15, 32, 39, 0.95);
            padding: 3rem 0;
            margin-top: 4rem;
            border-top: 3px solid #3498db;
        }
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        .footer-section h3 {
            color: #3498db;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }
        .footer-section p {
            color: #bdc3c7;
            line-height: 1.6;
        }
        .footer-links {
            list-style: none;
        }
        .footer-links li {
            margin-bottom: 10px;
        }
        .footer-links a {
            color: #bdc3c7;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-links a:hover {
            color: #3498db;
        }
        .copyright {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #95a5a6;
            font-size: 0.9rem;
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .mobile-buttons {
                display: flex;
            }
            .nav-menu, .search-container {
                display: none;
            }
            .hero h1 {
                font-size: 2.5rem;
            }
            .hero p {
                font-size: 1.1rem;
            }
            .hero-stats {
                flex-direction: column;
                gap: 1.5rem;
            }
            .video-grid {
                grid-template-columns: 1fr;
            }
            .player-container {
                width: 100%;
                margin: 0 10px;
            }
            .player-info {
                padding: 15px;
            }
            .player-actions {
                flex-wrap: wrap;
            }
            .container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="#" class="logo" onclick="showHomePage()">
                <div class="logo-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                EduZone LK
            </a>
            
            <!-- Desktop Navigation -->
            <ul class="nav-menu">
                <li><a href="#" class="nav-link active" data-page="new"><i class="fas fa-star new-icon"></i> New Lessons</a></li>
                <li><a href="#" class="nav-link" data-page="maths"><i class="fas fa-square-root-variable maths-icon"></i> Combined Maths</a></li>
                <li><a href="#" class="nav-link" data-page="physics"><i class="fas fa-atom physics-icon"></i> Physics</a></li>
            </ul>
            
            <!-- Desktop Search -->
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search lessons...">
                <i class="fas fa-search"></i>
            </div>
            
            <!-- Mobile Buttons -->
            <div class="mobile-buttons">
                <button class="mobile-btn" id="mobileSearchBtn">
                    <i class="fas fa-search"></i>
                </button>
                <button class="mobile-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
        <a href="#" class="mobile-nav-link active" data-page="new" onclick="handleMobileNav('new')">
            <i class="fas fa-star new-icon"></i> New Lessons
        </a>
        <a href="#" class="mobile-nav-link" data-page="maths" onclick="handleMobileNav('maths')">
            <i class="fas fa-square-root-variable maths-icon"></i> Combined Maths
        </a>
        <a href="#" class="mobile-nav-link" data-page="physics" onclick="handleMobileNav('physics')">
            <i class="fas fa-atom physics-icon"></i> Physics
        </a>
    </div>

    <!-- Mobile Search Overlay -->
    <div class="mobile-search-overlay" id="mobileSearchOverlay">
        <input type="text" class="mobile-search-input" id="mobileSearchInput" placeholder="Search lessons...">
    </div>

    <!-- MAIN CONTENT -->
    <div class="container" id="mainContent">
        <div class="hero">
            <h1>Master Maths & Physics</h1>
            <p>Your comprehensive learning platform with expert video lessons, practice problems, and interactive content</p>
            <div class="hero-stats">
                <div class="stat">
                    <div class="stat-number">250+</div>
                    <div class="stat-label">Video Lessons</div>
                </div>
                <div class="stat">
                    <div class="stat-number">98%</div>
                    <div class="stat-label">Success Rate</div>
                </div>
                <div class="stat">
                    <div class="stat-number">24/7</div>
                    <div class="stat-label">Access</div>
                </div>
            </div>
        </div>
        
        <div class="category-section" id="newSection">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-star section-icon new-icon"></i> New Lessons</h2>
            </div>
            <div id="newContainer" class="video-grid">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <div>Loading educational content...</div>
                </div>
            </div>
        </div>
        
        <div class="category-section" id="mathsSection">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-square-root-variable section-icon maths-icon"></i> Combined Maths</h2>
            </div>
            <div id="mathsContainer" class="video-grid">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <div>Loading maths lessons...</div>
                </div>
            </div>
        </div>
        
        <div class="category-section" id="physicsSection">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-atom section-icon physics-icon"></i> Physics</h2>
            </div>
            <div id="physicsContainer" class="video-grid">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <div>Loading physics lessons...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW VIDEO PLAYER MODAL -->
    <div class="video-player-modal" id="videoPlayerModal">
        <div class="player-container">
            <div class="player-header">
                <div class="player-title" id="playerTitle">Lesson Title</div>
                <button class="player-close" id="playerClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="video-wrapper">
                <iframe class="video-iframe" id="playerIframe" 
                        src="" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                </iframe>
            </div>
            <div class="player-info">
                <div class="player-description" id="playerDescription">
                    Lesson description will appear here.
                </div>
                <div class="player-meta">
                    <span id="playerViews"><i class="fas fa-eye"></i> 1K views</span>
                    <span id="playerDuration"><i class="fas fa-clock"></i> 10:00</span>
                    <span id="playerDifficulty"><i class="fas fa-signal"></i> Intermediate</span>
                </div>
                <div class="player-actions">
                    <button class="player-action-btn like-btn" id="likeBtn">
                        <i class="fas fa-thumbs-up"></i> Like
                    </button>
                    <button class="player-action-btn" id="shareBtn">
                        <i class="fas fa-share"></i> Share
                    </button>
                    <button class="player-action-btn save-btn" id="saveBtn">
                        <i class="fas fa-bookmark"></i> Save
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>EduZone LK</h3>
                <p>Your premier destination for mastering Combined Maths and Physics through engaging video lessons and comprehensive study materials.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Combined Maths</a></li>
                    <li><a href="#">Physics</a></li>
                    <li><a href="#">Practice Problems</a></li>
                    <li><a href="#">Study Guides</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Contact Us</h3>
                <ul class="footer-links">
                    <li><i class="fas fa-envelope"></i> support@edustreampro.com</li>
                    <li><i class="fas fa-phone"></i> +1 (555) 123-4567</li>
                    <li><i class="fas fa-map-marker-alt"></i> 123 Education Street, Learn City</li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            &copy; 2023 EduZone LK. All rights reserved.
        </div>
    </footer>

    <script>
        // Google Sheets Configuration
        const SPREADSHEET_ID = '1uE8vebUhRPpKeJDgaoK1jP0OKiowKijC8s6smrLRGHo';
        const API_KEY = 'AIzaSyDafFy0rVMj-eSVIOMN7KFrVnd-hJDYQNg';

        console.log('🚀 EduZone LK - Loading educational content from Google Sheets');

        let allVideos = [];

        // Mobile menu functions
        function toggleMobileMenu() {
            console.log('📱 Toggling mobile menu');
            const overlay = document.getElementById('mobileMenuOverlay');
            const searchOverlay = document.getElementById('mobileSearchOverlay');
            
            // Toggle menu
            overlay.classList.toggle('active');
            // Close search if open
            searchOverlay.classList.remove('active');
            
            console.log('Mobile menu active:', overlay.classList.contains('active'));
        }

        function toggleMobileSearch() {
            console.log('🔍 Toggling mobile search');
            const overlay = document.getElementById('mobileSearchOverlay');
            const menuOverlay = document.getElementById('mobileMenuOverlay');
            
            // Toggle search
            overlay.classList.toggle('active');
            // Close menu if open
            menuOverlay.classList.remove('active');
            
            // Focus on input
            if (overlay.classList.contains('active')) {
                setTimeout(() => {
                    document.getElementById('mobileSearchInput').focus();
                }, 100);
            }
        }

        function handleMobileNav(page) {
            console.log('📱 Mobile nav clicked:', page);
            
            // Close mobile menu
            document.getElementById('mobileMenuOverlay').classList.remove('active');
            
            // Update active states
            document.querySelectorAll('.mobile-nav-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Set active state
            document.querySelector(`.mobile-nav-link[data-page="${page}"]`).classList.add('active');
            document.querySelector(`.nav-link[data-page="${page}"]`).classList.add('active');
            
            // Show page
            showPage(page);
            displayVideosByCategory(page);
        }

        // Page navigation
        function showPage(page) {
            console.log('📄 Showing page:', page);
            
            // Hide all sections
            document.querySelectorAll('.category-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            const section = document.getElementById(page + 'Section');
            if (section) {
                section.style.display = 'block';
            }
        }

        function showHomePage() {
            document.getElementById('mainContent').style.display = 'block';
            closeAllOverlays();
        }

        function closeAllOverlays() {
            document.getElementById('mobileMenuOverlay').classList.remove('active');
            document.getElementById('mobileSearchOverlay').classList.remove('active');
        }

        // Google Sheets Connection
        async function fetchVideosFromSheets() {
            try {
                console.log('📡 Loading data from Google Sheets...');
                
                // Show loading state
                document.getElementById('newContainer').innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i><div>Loading your educational content from Google Sheets...</div></div>';
                document.getElementById('mathsContainer').innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i><div>Loading maths lessons...</div></div>';
                document.getElementById('physicsContainer').innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i><div>Loading physics lessons...</div></div>';
                
                const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/Sheet1?key=${API_KEY}`);
                
                console.log('🔍 Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`Failed to load data: ${response.status} ${response.statusText}`);
                }
                
                const data = await response.json();
                
                console.log('📊 Full data from Google Sheets:', data);
                
                if (!data.values || data.values.length < 2) {
                    console.log('❌ No video data found in sheet');
                    showErrorMessage('No educational content found in your Google Sheets. Please add some lessons to Sheet1.');
                    return [];
                }
                
                const videos = [];
                const headers = data.values[0].map(h => h.toLowerCase().trim());
                
                console.log('🔍 Headers found:', headers);
                
                for (let i = 1; i < data.values.length; i++) {
                    const row = data.values[i];
                    if (!row || !row[0] || row[0].trim() === '') continue;
                    
                    const video = {};
                    headers.forEach((header, index) => {
                        video[header] = (row[index] || '').toString().trim();
                    });
                    
                    // Validate required fields
                    if (!video.title) {
                        console.warn(`⚠️ Lesson at row ${i+1} missing title, skipping`);
                        continue;
                    }
                    
                    if (!video.url) {
                        console.warn(`⚠️ Lesson at row ${i+1} missing URL, skipping`);
                        continue;
                    }
                    
                    // Set defaults for optional fields
                    if (!video.description) video.description = 'No description available';
                    if (!video.duration) video.duration = '10:00';
                    if (!video.views) video.views = '1K views';
                    if (!video.tags) video.tags = 'general';
                    if (!video.category) video.category = 'new';
                    if (!video.difficulty) video.difficulty = 'Intermediate';
                    
                    // Generate thumbnail if not provided
                    if (!video.thumbnail || video.thumbnail.trim() === '') {
                        if (video.url.includes('youtube.com/watch?v=')) {
                            const videoId = video.url.split('v=')[1]?.split('&')[0];
                            if (videoId) {
                                video.thumbnail = `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`;
                            }
                        } else if (video.url.includes('youtu.be/')) {
                            const videoId = video.url.split('youtu.be/')[1]?.split('?')[0];
                            if (videoId) {
                                video.thumbnail = `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`;
                            }
                        }
                        
                        // Fallback thumbnail based on category
                        if (!video.thumbnail) {
                            if (video.category && video.category.toLowerCase() === 'maths') {
                                video.thumbnail = `https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=500&h=300&fit=crop&random=${i}`;
                            } else if (video.category && video.category.toLowerCase() === 'physics') {
                                video.thumbnail = `https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=500&h=300&fit=crop&random=${i}`;
                            } else {
                                video.thumbnail = `https://images.unsplash.com/photo-1497636577773-f1231844b336?w=500&h=300&fit=crop&random=${i}`;
                            }
                        }
                    }
                    
                    // Convert YouTube URL to embed URL
                    if (video.url.includes('youtube.com/watch?v=')) {
                        const videoId = video.url.split('v=')[1]?.split('&')[0];
                        if (videoId) {
                            video.embedUrl = `https://www.youtube.com/embed/${videoId}`;
                        }
                    } else if (video.url.includes('youtu.be/')) {
                        const videoId = video.url.split('youtu.be/')[1]?.split('?')[0];
                        if (videoId) {
                            video.embedUrl = `https://www.youtube.com/embed/${videoId}`;
                        }
                    } else {
                        video.embedUrl = video.url; // Use as-is for other video platforms
                    }
                    
                    videos.push(video);
                }
                
                console.log(`✅ Successfully processed ${videos.length} lessons from database`);
                return videos;
                
            } catch (error) {
                console.error('❌ Error loading from Google Sheets:', error);
                showErrorMessage(`Error loading educational content: ${error.message}. Please check your Google Sheets configuration.`);
                return [];
            }
        }

        function showErrorMessage(message) {
            const containers = ['newContainer', 'mathsContainer', 'physicsContainer'];
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = `
                        <div class="loading" style="text-align: center; padding: 3rem;">
                            <i class="fas fa-exclamation-triangle" style="color: #e74c3c; font-size: 2rem; margin-bottom: 1rem;"></i>
                            <div>${message}</div>
                            <div style="margin-top: 1rem; font-size: 0.8rem; color: #bdc3c7;">
                                Check: API Key, Spreadsheet ID, and Sheet permissions
                            </div>
                        </div>
                    `;
                }
            });
        }

        // Video display functions
        function createVideoCard(video, index) {
            const tagClass = video.category && video.category.toLowerCase() === 'physics' ? 'physics-tag' : 'maths-tag';
            
            return `
                <div class="video-card" onclick="playVideo(${index})">
                    <div class="video-thumbnail">
                        <img class="thumbnail-image" 
                             src="${video.thumbnail}" 
                             alt="${video.title}"
                             onerror="this.src='https://images.unsplash.com/photo-1497636577773-f1231844b336?w=500&h=300&fit=crop'">
                        <div class="video-duration">${video.duration}</div>
                    </div>
                    <div class="video-info">
                        <h3 class="video-title">${video.title}</h3>
                        <p class="video-description">${video.description}</p>
                        <div class="video-meta">
                            <span><i class="fas fa-eye"></i> ${video.views}</span>
                            <span><i class="fas fa-signal"></i> ${video.difficulty || 'Intermediate'}</span>
                        </div>
                        <div class="video-tags">
                            <span class="video-tag ${tagClass}">${video.category || 'General'}</span>
                            ${video.tags.split(',').slice(0, 2).map(tag => 
                                `<span class="video-tag">${tag.trim()}</span>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // IMPROVED VIDEO PLAYER
        function playVideo(index) {
            const video = allVideos[index];
            if (!video) return;
            
            const modal = document.getElementById('videoPlayerModal');
            const iframe = document.getElementById('playerIframe');
            const title = document.getElementById('playerTitle');
            const description = document.getElementById('playerDescription');
            const views = document.getElementById('playerViews');
            const duration = document.getElementById('playerDuration');
            const difficulty = document.getElementById('playerDifficulty');
            
            // Set video data
            title.textContent = video.title;
            description.textContent = video.description;
            views.innerHTML = `<i class="fas fa-eye"></i> ${video.views}`;
            duration.innerHTML = `<i class="fas fa-clock"></i> ${video.duration}`;
            difficulty.innerHTML = `<i class="fas fa-signal"></i> ${video.difficulty || 'Intermediate'}`;
            
            // Set iframe source
            iframe.src = video.embedUrl || video.url;
            
            // Show modal
            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent scrolling
            
            console.log('🎬 Playing lesson:', video.title);
        }

        function closeVideoPlayer() {
            const modal = document.getElementById('videoPlayerModal');
            const iframe = document.getElementById('playerIframe');
            
            // Stop video playback
            iframe.src = '';
            
            // Hide modal
            modal.classList.remove('active');
            document.body.style.overflow = 'auto'; // Re-enable scrolling
            
            console.log('⏹️ Video player closed');
        }

        // FIXED CATEGORY FILTERING - NO DUPLICATES
        function displayVideosByCategory(category = 'new') {
            console.log('🎯 Displaying lessons for category:', category);
            
            if (allVideos.length === 0) {
                const container = document.getElementById(category + 'Container');
                container.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i><div>Loading lessons from your database...</div></div>';
                return;
            }
            
            let filteredVideos = [];
            
            // FIXED: Proper category filtering with no duplicates
            if (category === 'new') {
                // Show first 20 lessons for new releases (regardless of category)
                filteredVideos = allVideos.slice(0, 20);
            } else if (category === 'maths') {
                // Only show lessons with category 'maths'
                filteredVideos = allVideos.filter(v => 
                    v.category && v.category.toLowerCase() === 'maths'
                );
            } else if (category === 'physics') {
                // Only show lessons with category 'physics'
                filteredVideos = allVideos.filter(v => 
                    v.category && v.category.toLowerCase() === 'physics'
                );
            }
            
            const container = document.getElementById(category + 'Container');
            
            if (filteredVideos.length === 0) {
                container.innerHTML = `
                    <div class="loading">
                        <i class="fas fa-video-slash" style="color: #3498db; font-size: 2rem; margin-bottom: 1rem;"></i>
                        <div>No lessons found in ${category} category</div>
                        <div style="margin-top: 0.5rem; font-size: 0.8rem; color: #bdc3c7;">
                            Add "category" column to your Google Sheets with values: new, maths, physics
                        </div>
                    </div>
                `;
            } else {
                let html = '';
                filteredVideos.forEach((video, index) => {
                    const videoIndex = allVideos.findIndex(v => v.url === video.url);
                    html += createVideoCard(video, videoIndex);
                });
                container.innerHTML = html;
            }
            
            console.log(`📊 Displayed ${filteredVideos.length} lessons in ${category} category`);
        }

        // Search functionality
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            const mobileSearchInput = document.getElementById('mobileSearchInput');
            
            function handleSearch(searchTerm) {
                console.log('🔍 Searching:', searchTerm);
                
                if (!searchTerm.trim()) {
                    const activePage = document.querySelector('.nav-link.active').getAttribute('data-page');
                    displayVideosByCategory(activePage);
                    return;
                }
                
                const filteredVideos = allVideos.filter(video => 
                    video.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    (video.description && video.description.toLowerCase().includes(searchTerm.toLowerCase())) ||
                    (video.tags && video.tags.toLowerCase().includes(searchTerm.toLowerCase())) ||
                    (video.difficulty && video.difficulty.toLowerCase().includes(searchTerm.toLowerCase()))
                );
                
                const activePage = document.querySelector('.nav-link.active').getAttribute('data-page');
                const container = document.getElementById(activePage + 'Container');
                
                if (filteredVideos.length === 0) {
                    container.innerHTML = '<div class="loading"><i class="fas fa-search"></i><div>No lessons found matching your search</div></div>';
                } else {
                    let html = '';
                    filteredVideos.forEach((video, index) => {
                        const videoIndex = allVideos.findIndex(v => v.url === video.url);
                        html += createVideoCard(video, videoIndex);
                    });
                    container.innerHTML = html;
                }
                
                // Close mobile search after searching
                document.getElementById('mobileSearchOverlay').classList.remove('active');
            }
            
            searchInput.addEventListener('input', (e) => handleSearch(e.target.value));
            mobileSearchInput.addEventListener('input', (e) => handleSearch(e.target.value));
            
            // Handle Enter key in mobile search
            mobileSearchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleSearch(e.target.value);
                }
            });
        }

        // Desktop navigation
        function setupDesktopNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    
                    // Update active states
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.mobile-nav-link').forEach(mobileLink => {
                        mobileLink.classList.remove('active');
                    });
                    document.querySelector(`.mobile-nav-link[data-page="${page}"]`).classList.add('active');
                    
                    // Show page
                    showPage(page);
                    displayVideosByCategory(page);
                });
            });
        }

        // Initialize everything
        async function init() {
            console.log('🔧 Initializing EduZone Lk...');
            
            // Setup mobile buttons
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);
            document.getElementById('mobileSearchBtn').addEventListener('click', toggleMobileSearch);
            
            // Setup video player close button
            document.getElementById('playerClose').addEventListener('click', closeVideoPlayer);
            
            // Close video player when clicking outside
            document.getElementById('videoPlayerModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeVideoPlayer();
                }
            });
            
            // Close video player with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeVideoPlayer();
                }
            });
            
            // Setup action buttons
            document.getElementById('likeBtn').addEventListener('click', function() {
                alert('Lesson liked! This helps us improve our content.');
            });
            
            document.getElementById('shareBtn').addEventListener('click', function() {
                alert('Share this lesson with your classmates!');
            });
            
            document.getElementById('saveBtn').addEventListener('click', function() {
                alert('Lesson saved to your study list!');
            });
            
            // Close overlays when clicking outside
            document.addEventListener('click', (e) => {
                const menuOverlay = document.getElementById('mobileMenuOverlay');
                const searchOverlay = document.getElementById('mobileSearchOverlay');
                const menuBtn = document.getElementById('mobileMenuBtn');
                const searchBtn = document.getElementById('mobileSearchBtn');
                
                if (menuOverlay.classList.contains('active') && 
                    !menuOverlay.contains(e.target) && 
                    !menuBtn.contains(e.target)) {
                    menuOverlay.classList.remove('active');
                }
                
                if (searchOverlay.classList.contains('active') && 
                    !searchOverlay.contains(e.target) && 
                    !searchBtn.contains(e.target)) {
                    searchOverlay.classList.remove('active');
                }
            });
            
            // Load videos from Google Sheets
            console.log('📥 Fetching educational content from your database...');
            allVideos = await fetchVideosFromSheets();
            
            if (allVideos.length > 0) {
                console.log('✅ Successfully loaded', allVideos.length, 'lessons from your database');
                
                // Setup functionality
                setupDesktopNavigation();
                setupSearch();
                displayVideosByCategory('new');
                
                console.log('🎉 EduZone LK initialized successfully with educational content!');
            } else {
                console.log('❌ No lessons loaded from database');
                
                // Show sample data as fallback with proper categories
                const sampleVideos = [
                    {
                        title: "Introduction to Calculus - Limits & Continuity",
                        description: "Learn the fundamentals of calculus with focus on limits and continuity. Essential for Combined Maths students.",
                        url: "https://www.youtube.com/embed/9W_6iW_nXUc",
                        thumbnail: "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=500&h=300&fit=crop",
                        duration: "15:30",
                        views: "2.5K views",
                        tags: "calculus,limits,continuity",
                        category: "maths",
                        difficulty: "Intermediate"
                    },
                    {
                        title: "Newton's Laws of Motion - Physics Fundamentals",
                        description: "Comprehensive overview of Newton's three laws of motion with practical examples and problem-solving techniques.",
                        url: "https://www.youtube.com/embed/dQw4w9WgXcQ",
                        thumbnail: "https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=500&h=300&fit=crop",
                        duration: "22:15",
                        views: "3.8K views",
                        tags: "newton,laws,motion,mechanics",
                        category: "physics",
                        difficulty: "Beginner"
                    },
                    {
                        title: "Trigonometric Functions & Identities",
                        description: "Master trigonometric functions, identities, and their applications in solving complex mathematical problems.",
                        url: "https://www.youtube.com/embed/jNQXAC9IVRw",
                        thumbnail: "https://images.unsplash.com/photo-1509228468518-180dd4864904?w=500&h=300&fit=crop",
                        duration: "18:45",
                        views: "1.9K views",
                        tags: "trigonometry,functions,identities",
                        category: "maths",
                        difficulty: "Intermediate"
                    },
                    {
                        title: "Electricity & Magnetism - Core Concepts",
                        description: "Explore the fundamental principles of electricity and magnetism with real-world applications and problem sets.",
                        url: "https://www.youtube.com/embed/L_jWHffIx5E",
                        thumbnail: "https://images.unsplash.com/photo-1605649487212-47bdab064df7?w=500&h=300&fit=crop",
                        duration: "25:10",
                        views: "4.2K views",
                        tags: "electricity,magnetism,electromagnetism",
                        category: "physics",
                        difficulty: "Advanced"
                    },
                    {
                        title: "Differential Equations - Solving Techniques",
                        description: "Learn various methods to solve differential equations with step-by-step examples and practice problems.",
                        url: "https://www.youtube.com/embed/WFr2WgN9_xE",
                        thumbnail: "https://images.unsplash.com/photo-1589254065878-42c9da997cc6?w=500&h=300&fit=crop",
                        duration: "28:35",
                        views: "1.5K views",
                        tags: "differential,equations,calculus",
                        category: "maths",
                        difficulty: "Advanced"
                    },
                    {
                        title: "Modern Physics - Quantum Mechanics Introduction",
                        description: "Introduction to the fascinating world of quantum mechanics and its implications in modern physics.",
                        url: "https://www.youtube.com/embed/IGY9HPSyR6Q",
                        thumbnail: "https://images.unsplash.com/photo-1502134249126-9f3755a50d78?w=500&h=300&fit=crop",
                        duration: "20:50",
                        views: "3.1K views",
                        tags: "quantum,mechanics,modern,physics",
                        category: "physics",
                        difficulty: "Advanced"
                    }
                ];
                allVideos = sampleVideos;
                displayVideosByCategory('new');
            }
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>

